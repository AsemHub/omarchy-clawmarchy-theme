---
phase: 04-accent-variants-and-wallpapers
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - variants/sakura/colors.toml
  - variants/sakura/btop.theme
  - variants/sakura/hyprland.conf
  - variants/sakura/hyprlock.conf
  - variants/sakura/mako.ini
  - variants/sakura/waybar.css
  - variants/sakura/walker.css
  - variants/sakura/swayosd.css
  - variants/sakura/vscode.json
  - variants/ocean/colors.toml
  - variants/ocean/btop.theme
  - variants/ocean/hyprland.conf
  - variants/ocean/hyprlock.conf
  - variants/ocean/mako.ini
  - variants/ocean/waybar.css
  - variants/ocean/walker.css
  - variants/ocean/swayosd.css
  - variants/ocean/vscode.json
  - variants/tide/colors.toml
  - variants/tide/btop.theme
  - variants/tide/hyprland.conf
  - variants/tide/hyprlock.conf
  - variants/tide/mako.ini
  - variants/tide/waybar.css
  - variants/tide/walker.css
  - variants/tide/swayosd.css
  - variants/tide/vscode.json
  - variants/ember/colors.toml
  - variants/ember/btop.theme
  - variants/ember/hyprland.conf
  - variants/ember/hyprlock.conf
  - variants/ember/mako.ini
  - variants/ember/waybar.css
  - variants/ember/walker.css
  - variants/ember/swayosd.css
  - variants/ember/vscode.json
  - variants/moss/colors.toml
  - variants/moss/btop.theme
  - variants/moss/hyprland.conf
  - variants/moss/hyprlock.conf
  - variants/moss/mako.ini
  - variants/moss/waybar.css
  - variants/moss/walker.css
  - variants/moss/swayosd.css
  - variants/moss/vscode.json
  - variants/yoru/colors.toml
  - variants/yoru/btop.theme
  - variants/yoru/hyprland.conf
  - variants/yoru/hyprlock.conf
  - variants/yoru/mako.ini
  - variants/yoru/waybar.css
  - variants/yoru/walker.css
  - variants/yoru/swayosd.css
  - variants/yoru/vscode.json
autonomous: true
requirements:
  - VAR-01
  - VAR-02
  - VAR-03
  - VAR-04

must_haves:
  truths:
    - "5 new accent variant directories exist alongside the default purple in root"
    - "Every variant's accent color passes WCAG 4.5:1 contrast ratio against #000000"
    - "No leftover default purple hex (#7B6CBD) appears in any non-purple variant config file (except Moss btop.theme temp_mid)"
    - "Each variant contains all 9 accent-dependent config files with correct accent values in all formats"
    - "btop.theme box outlines use the variant accent in every variant"
  artifacts:
    - path: "variants/sakura/"
      provides: "Pink accent variant (9 config files)"
      contains: "D4839B"
    - path: "variants/ocean/"
      provides: "Blue accent variant (9 config files)"
      contains: "5B8EC9"
    - path: "variants/tide/"
      provides: "Teal accent variant (9 config files)"
      contains: "5AB5B5"
    - path: "variants/ember/"
      provides: "Orange accent variant (9 config files)"
      contains: "D4895A"
    - path: "variants/moss/"
      provides: "Green accent variant (9 config files)"
      contains: "6EA88E"
    - path: "variants/yoru/"
      provides: "Default purple restore point (9 config files)"
      contains: "7B6CBD"
  key_links:
    - from: "variants/*/colors.toml"
      to: "colors.toml"
      via: "accent and selection_background values replaced"
      pattern: "accent.*=.*\"#(D4839B|5B8EC9|5AB5B5|D4895A|6EA88E)\""
    - from: "variants/*/btop.theme"
      to: "btop.theme"
      via: "8 accent-role values replaced, core gradients preserved"
      pattern: "theme\\[(hi_fg|selected_fg|proc_misc|cpu_box|mem_box|net_box|proc_box)\\]"
---

<objective>
Generate all accent variant config files for 5 new color variants (Sakura, Ocean, Tide, Ember, Moss) plus a Yoru restore directory, with WCAG contrast verification.

Purpose: This is the core deliverable of Phase 4 -- creating the actual themed config files that users will install. Each variant replaces the accent color across 9 config files in all 4 accent formats (hex, strip, decimal RGB, alpha-appended).

Output: 6 variant subdirectories under `variants/` (5 new + 1 default restore), each containing 9 config files. All variants WCAG-verified.
</objective>

<execution_context>
@/home/asem/.claude/get-shit-done/workflows/execute-plan.md
@/home/asem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-accent-variants-and-wallpapers/04-RESEARCH.md
@colors.toml
@btop.theme
@hyprland.conf
@hyprlock.conf
@mako.ini
@waybar.css
@walker.css
@swayosd.css
@vscode.json
@COLORS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate all variant config files via Python substitution script</name>
  <files>
    variants/sakura/colors.toml
    variants/sakura/btop.theme
    variants/sakura/hyprland.conf
    variants/sakura/hyprlock.conf
    variants/sakura/mako.ini
    variants/sakura/waybar.css
    variants/sakura/walker.css
    variants/sakura/swayosd.css
    variants/sakura/vscode.json
    variants/ocean/colors.toml
    variants/ocean/btop.theme
    variants/ocean/hyprland.conf
    variants/ocean/hyprlock.conf
    variants/ocean/mako.ini
    variants/ocean/waybar.css
    variants/ocean/walker.css
    variants/ocean/swayosd.css
    variants/ocean/vscode.json
    variants/tide/colors.toml
    variants/tide/btop.theme
    variants/tide/hyprland.conf
    variants/tide/hyprlock.conf
    variants/tide/mako.ini
    variants/tide/waybar.css
    variants/tide/walker.css
    variants/tide/swayosd.css
    variants/tide/vscode.json
    variants/ember/colors.toml
    variants/ember/btop.theme
    variants/ember/hyprland.conf
    variants/ember/hyprlock.conf
    variants/ember/mako.ini
    variants/ember/waybar.css
    variants/ember/walker.css
    variants/ember/swayosd.css
    variants/ember/vscode.json
    variants/moss/colors.toml
    variants/moss/btop.theme
    variants/moss/hyprland.conf
    variants/moss/hyprlock.conf
    variants/moss/mako.ini
    variants/moss/waybar.css
    variants/moss/walker.css
    variants/moss/swayosd.css
    variants/moss/vscode.json
    variants/yoru/colors.toml
    variants/yoru/btop.theme
    variants/yoru/hyprland.conf
    variants/yoru/hyprlock.conf
    variants/yoru/mako.ini
    variants/yoru/waybar.css
    variants/yoru/walker.css
    variants/yoru/swayosd.css
    variants/yoru/vscode.json
  </files>
  <action>
Create a Python script that generates all variant config files. The script must:

1. **Define the 6 variants with all accent formats:**

| Variant | Hex | Strip | Decimal RGB | +40 Alpha | +30 Alpha |
|---------|-----|-------|-------------|-----------|-----------|
| yoru | #7B6CBD | 7B6CBD | 123,108,189 | #7B6CBD40 | #7B6CBD30 |
| sakura | #D4839B | D4839B | 212,131,155 | #D4839B40 | #D4839B30 |
| ocean | #5B8EC9 | 5B8EC9 | 91,142,201 | #5B8EC940 | #5B8EC930 |
| tide | #5AB5B5 | 5AB5B5 | 90,181,181 | #5AB5B540 | #5AB5B530 |
| ember | #D4895A | D4895A | 212,137,90 | #D4895A40 | #D4895A30 |
| moss | #6EA88E | 6EA88E | 110,168,142 | #6EA88E40 | #6EA88E30 |

2. **For each variant, create `variants/<name>/` directory.**

3. **For each of the 9 source files** (colors.toml, btop.theme, hyprland.conf, hyprlock.conf, mako.ini, waybar.css, walker.css, swayosd.css, vscode.json):
   - Read the root file
   - Replace ALL occurrences of the default accent in ALL 4 formats:
     - `#7B6CBD` -> `#<NEW_HEX>` (hex with hash)
     - `7B6CBD` -> `<NEW_STRIP>` (hex without hash, used in hyprland.conf `rgb()`)
     - `123,108,189` -> `<NEW_R>,<NEW_G>,<NEW_B>` (decimal RGB, used in hyprlock.conf `rgba()`)
     - `#7B6CBD40` -> `#<NEW_STRIP>40` (alpha-appended, vscode.json)
     - `#7B6CBD30` -> `#<NEW_STRIP>30` (alpha-appended, vscode.json)
   - Write the result to `variants/<name>/<filename>`

4. **Special handling for btop.theme temp_mid:**
   - After the global accent replacement, apply per-variant temp_mid logic
   - The temperature gradient goes: temp_start (cyan #5AA8B5, hue 189) -> temp_mid -> temp_end (red #C45B6E, hue 349)
   - For Moss (hue 153): the accent is BELOW cyan on the hue wheel, which breaks the cool-to-warm progression. After replacing all accent values globally, re-set `theme[temp_mid]` back to `"#7B6CBD"` (the default purple that fits the gradient). Add a comment: `# Uses default accent -- Moss hue (153) below cyan (189) breaks gradient`
   - For all other variants (Sakura hue 342, Ocean hue 212, Tide hue 180, Ember hue 23): the accent sits naturally between cyan and red on the hue wheel (wrapping past 0 for Ember). Let the global replacement stand -- temp_mid uses the variant accent.

5. **Handle the replacement order carefully:**
   - Replace longer strings first: `#7B6CBD40` before `#7B6CBD`, and `#7B6CBD30` before `#7B6CBD`
   - This prevents partial matches (replacing `#7B6CBD` inside `#7B6CBD40`)
   - For the strip format, only replace `7B6CBD` when NOT preceded by `#` (use negative lookbehind or replace after the hash-prefixed version)

6. **Also update annotation comments** where they reference the accent hex value:
   - `_comment_accent` values in vscode.json should reflect the new accent hex
   - The header comment "Clawmarchy Theme" and "Clawmarchy btop theme" headers stay unchanged (theme name is constant)

7. **Run the script** to generate all 54 files (6 variants x 9 files).

8. **Delete the generation script** after running -- it is a one-time tool, not a shipped artifact. (Or keep it if useful for future regeneration -- Claude's discretion.)

IMPORTANT: The yoru directory is a restore point -- it contains exact copies of the root files. When the script runs for yoru, no replacements occur (old accent = new accent), so the files are identical copies. This enables `clawmarchy-variant yoru` to restore the default after switching to another variant.
  </action>
  <verify>
    - `ls variants/` shows 6 directories: sakura, ocean, tide, ember, moss, yoru
    - Each directory contains exactly 9 files: `ls variants/sakura/ | wc -l` returns 9
    - `grep -c '#D4839B' variants/sakura/colors.toml` returns at least 2 (accent + selection_background)
    - `grep -c 'D4839B' variants/sakura/hyprland.conf` returns at least 1 (rgb() format)
    - `grep -c '212,131,155' variants/sakura/hyprlock.conf` returns at least 3 (outer_color, check_color, clock label)
    - `grep -c '#D4839B40' variants/sakura/vscode.json` returns at least 1 (selection.background alpha)
    - `grep -rn '7B6CBD' variants/sakura/` returns 0 matches (no leftover default accent)
    - `grep -rn '7B6CBD' variants/ocean/` returns 0 matches
    - `grep -rn '7B6CBD' variants/tide/` returns 0 matches
    - `grep -rn '7B6CBD' variants/ember/` returns 0 matches
    - `grep -rn '7B6CBD' variants/moss/` returns exactly the btop.theme temp_mid line only
    - `diff variants/yoru/colors.toml colors.toml` returns no differences
  </verify>
  <done>
    6 variant directories exist under variants/, each containing 9 config files with the correct accent hex in all 4 formats. No leftover default purple in non-purple variants (except Moss btop.theme temp_mid). Yoru directory matches root files exactly.
  </done>
</task>

<task type="auto">
  <name>Task 2: WCAG contrast verification and comprehensive accent audit</name>
  <files>
    (no new files -- verification only)
  </files>
  <action>
Create and run a Python verification script that:

1. **WCAG 4.5:1 contrast ratio verification** for all 6 variants against #000000:

```python
def relative_luminance(hex_color):
    hex_color = hex_color.lstrip('#')
    r, g, b = int(hex_color[0:2], 16)/255.0, int(hex_color[2:4], 16)/255.0, int(hex_color[4:6], 16)/255.0
    def linearize(c):
        return c/12.92 if c <= 0.04045 else ((c + 0.055)/1.055)**2.4
    return 0.2126 * linearize(r) + 0.7152 * linearize(g) + 0.0722 * linearize(b)

def contrast_ratio(hex1, hex2):
    l1 = relative_luminance(hex1)
    l2 = relative_luminance(hex2)
    lighter, darker = max(l1, l2), min(l1, l2)
    return (lighter + 0.05) / (darker + 0.05)
```

Verify each variant accent passes 4.5:1:
| Variant | Accent | Expected Ratio |
|---------|--------|----------------|
| Yoru | #7B6CBD | ~4.72:1 |
| Sakura | #D4839B | ~7.52:1 |
| Ocean | #5B8EC9 | ~6.16:1 |
| Tide | #5AB5B5 | ~8.71:1 |
| Ember | #D4895A | ~7.53:1 |
| Moss | #6EA88E | ~7.65:1 |

Print each ratio. Assert all >= 4.5.

2. **Leftover accent audit** across ALL variant directories:
   - For each non-yoru variant, grep for `7B6CBD` (case-insensitive) in all files
   - For Moss: expect exactly 1 match (btop.theme temp_mid) -- any additional matches are errors
   - For Sakura, Ocean, Tide, Ember: expect 0 matches
   - Report any failures with file path and line number

3. **Cross-variant accent consistency check:**
   - For each variant, read its `colors.toml` and extract the `accent` value
   - Verify the same hex appears in the expected locations across all 9 files:
     - btop.theme: hi_fg, selected_fg, proc_misc, cpu_box, mem_box, net_box, proc_box (7 of 8 accent values)
     - hyprland.conf: rgb() value
     - hyprlock.conf: decimal RGB in rgba() calls
     - mako.ini: border-color value
     - waybar.css: accent hex occurrences
     - walker.css: selected-text and border define-color values
     - swayosd.css: progress define-color value
     - vscode.json: tab.activeBorderTop, focusBorder values

Print PASS/FAIL summary for each variant.

Delete the verification script after running -- not a shipped artifact.
  </action>
  <verify>
    - Python script exits with code 0 (all assertions pass)
    - All 6 contrast ratios are >= 4.5:1
    - Leftover accent audit: 0 matches for sakura/ocean/tide/ember, 1 match for moss (temp_mid only)
    - Cross-variant consistency: PASS for all 6 variants
  </verify>
  <done>
    All 6 accent variants verified: WCAG 4.5:1 contrast passes, no leftover default accent (except Moss temp_mid), and accent hex appears consistently across all 9 config files in each variant.
  </done>
</task>

</tasks>

<verification>
1. `ls variants/` shows: ember, moss, ocean, sakura, tide, yoru
2. Each variant directory contains exactly 9 files
3. `grep -rn '7B6CBD' variants/sakura/ variants/ocean/ variants/tide/ variants/ember/` returns no output
4. `grep -rn '7B6CBD' variants/moss/` returns only the btop.theme temp_mid line
5. Python WCAG verification passes with all ratios >= 4.5:1
6. `diff variants/yoru/colors.toml colors.toml` shows no differences
</verification>

<success_criteria>
- 6 variant directories (sakura, ocean, tide, ember, moss, yoru) exist under variants/
- Each contains 9 correctly themed config files
- All accent colors pass WCAG 4.5:1 contrast against #000000
- Zero leftover default accent values in non-purple variants (Moss temp_mid excepted)
- btop.theme core gradients (cpu, mem, network, process, download, upload, free, cached, available) are identical across all variants (only accent-role values differ)
</success_criteria>

<output>
After completion, create `.planning/phases/04-accent-variants-and-wallpapers/04-01-SUMMARY.md`
</output>
